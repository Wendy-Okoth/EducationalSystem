{% extends "base_student.html" %}
{% block content %}
<div class="max-w-4xl mx-auto py-8 px-4">
    <div class="bg-white shadow-xl rounded-2xl p-8 border-2 border-kas-dark-green mb-8 flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-black text-kas-dark-green">Review: {{ quiz.title }}</h1>
            <p class="text-slate-500 font-bold uppercase text-xs tracking-widest">Completed on {{ attempt.end_time.strftime('%d %b, %Y') }}</p>
        </div>
        <div class="text-right">
            <div class="text-4xl font-black text-kas-dark-green">{{ attempt.score|int }}/{{ attempt.total_possible|int }}</div>
            <p class="text-[10px] uppercase font-bold text-slate-400">Final Score</p>
        </div>
    </div>

    {% for q in quiz.questions %}
    <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-8 mb-6">
        <p class="text-lg font-bold text-slate-800 mb-6">{{ loop.index }}. {{ q.text }}</p>
        
        <div class="space-y-3">
            {% for opt in q.options %}
                {% set is_correct = opt.is_correct %}
                {# In a real app, you might need a 'UserAnswer' model to track specific choices, 
                   but if you aren't saving specific choices, we highlight the Correct one. #}
                
                <div class="flex items-center p-4 rounded-xl border-2 transition-all
                    {% if is_correct %} border-green-500 bg-green-50 {% else %} border-slate-50 {% endif %}">
                    
                    <i class="fas {% if is_correct %} fa-check-circle text-green-500 {% else %} fa-circle text-slate-200 {% endif %} mr-4"></i>
                    
                    <span class="font-medium {% if is_correct %} text-green-700 {% else %} text-slate-600 {% endif %}">
                        {{ opt.text }}
                    </span>

                    {% if is_correct %}
                        <span class="ml-auto text-[10px] font-black uppercase text-green-600 tracking-tighter">Correct Answer</span>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    </div>
    {% endfor %}

    <a href="{{ url_for('student.subject_detail', subject_id=quiz.subject_id) }}" 
       class="block text-center w-full py-4 bg-kas-dark-green text-white rounded-2xl font-black text-xl hover:bg-kas-light-brown transition shadow-lg">
        Back to Subject
    </a>
</div>
{% endblock %}